#!/usr/bin/env node
const{execSync:execSync}=require("child_process"),MAP_EMOJI={add:"ðŸ’ª",alert:"ðŸ›Ž",attach:"ðŸ–‡",bring:"ðŸ‘Œ",cancel:"âŒ",change:"ðŸ§¬",complete:"âœ…",coverage:"â˜‚",delete:"ðŸ•Š",deliver:"ðŸ¤",deploy:"âœ…",destroy:"âŒ",extend:"ðŸ’ª",fix:"ðŸ”§",forbid:"â—",implement:"ðŸ’ª",improve:"ðŸŽ‰",include:"ðŸ’ª",introduce:"ðŸ’ª",kill:"âŒ",limit:"â—",merge:"â™»ï¸",modify:"ðŸ”¨",pass:"âœ…",prepare:"ðŸ”§",refactor:"ðŸ”¨",release:"ðŸŽ‚",remove:"ðŸ•Š",rename:"ðŸ–Š",restrain:"â—",return:"ðŸ’ª",revert:"âŒ",show:"ðŸ‘",test:"ðŸ¥½",tweak:"ðŸ§¬",update:"ðŸ‘Œ",use:"ðŸ¤"},getTicketNameFromBranch=()=>{const e=(e="")=>[...e].reverse().join(""),t=e(execSync("git branch --show-current").toString()).match(/\d+-[A-Z]+(?!-?[a-zA-Z]{1,10})/g)||[],[r]=t.map(e);return r?r+": ":""},getUserProvidedMessage=()=>{const e=process.argv.splice(2).join(" ").trim();return 0===e.length?"ðŸ”¨ commit without message":e||""},getEmojiFromText=(e="")=>{const t=e.toLowerCase().split(" "),r=["","s","es","ed","d"];for(let e=0;e<t.length;e++)for(let o=0;o<r.length;o++){const c=MAP_EMOJI[t[e]+r[o]];if(c)return c+" "}return""},execCommit=()=>{const e=getUserProvidedMessage(),t=getEmojiFromText(e),r=`${getTicketNameFromBranch()}${t}${e}`.replace(/"/g,'\\"');try{return execSync(`git commit -m "${r}"`).toString()}catch(e){return e.stdout.toString()}};console.log(execCommit());